<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Sistema Lavandería RFID</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f7fa;
        }
        .test-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .success {
            color: #48bb78;
            font-weight: bold;
        }
        .error {
            color: #f56565;
            font-weight: bold;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #e2e8f0;
        }
        .test-item.ok {
            border-left-color: #48bb78;
            background: #f0fff4;
        }
        .test-item.fail {
            border-left-color: #f56565;
            background: #fed7d7;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <div class="test-box">
        <h1>🧺 Test del Sistema de Lavandería RFID</h1>
        <p>Este archivo verifica que todos los componentes estén funcionando correctamente.</p>
        
        <h3>📋 Resultados de la Verificación:</h3>
        <div id="test-results">
            <div class="test-item" id="test-scripts">
                📁 Verificando archivos JavaScript...
            </div>
            <div class="test-item" id="test-styles">
                🎨 Verificando archivos CSS...
            </div>
            <div class="test-item" id="test-storage">
                🗄️ Verificando localStorage...
            </div>
            <div class="test-item" id="test-app">
                ⚙️ Verificando aplicación principal...
            </div>
        </div>
        
        <div style="margin-top: 30px;">
            <button onclick="runTests()">🔄 Ejecutar Pruebas</button>
            <button onclick="window.open('index.html', '_blank')">🚀 Abrir Sistema Principal</button>
            <button onclick="clearData()">🗑️ Limpiar Datos</button>
        </div>
        
        <div id="error-details" style="margin-top: 20px; display: none;">
            <h3>❌ Detalles de Errores:</h3>
            <pre id="error-content" style="background: #f7fafc; padding: 15px; border-radius: 5px; overflow-x: auto;"></pre>
        </div>
    </div>

    <script>
        let errors = [];
        
        function logError(message) {
            errors.push(message);
            console.error(message);
        }
        
        function updateTestResult(testId, success, message) {
            const element = document.getElementById(testId);
            element.className = `test-item ${success ? 'ok' : 'fail'}`;
            element.textContent = `${success ? '✅' : '❌'} ${message}`;
        }
        
        function runTests() {
            errors = [];
            document.getElementById('error-details').style.display = 'none';
            
            // Test 1: Verificar archivos JavaScript
            testScripts();
            
            // Test 2: Verificar archivos CSS
            testStyles();
            
            // Test 3: Verificar localStorage
            testStorage();
            
            // Test 4: Verificar aplicación
            testApp();
            
            // Mostrar errores si los hay
            if (errors.length > 0) {
                document.getElementById('error-content').textContent = errors.join('\n');
                document.getElementById('error-details').style.display = 'block';
            }
        }
        
        function testScripts() {
            const scripts = [
                'js/app.js', 'js/auth.js', 'js/navigation.js', 'js/storage.js',
                'js/dashboard.js', 'js/clients.js', 'js/reception.js', 'js/control.js',
                'js/delivery.js', 'js/history.js', 'js/reports.js', 'js/guides.js'
            ];
            
            let loadedCount = 0;
            let failedCount = 0;
            
            scripts.forEach(script => {
                fetch(script)
                    .then(response => {
                        if (response.ok) {
                            loadedCount++;
                        } else {
                            failedCount++;
                            logError(`No se pudo cargar: ${script}`);
                        }
                        
                        if (loadedCount + failedCount === scripts.length) {
                            updateTestResult('test-scripts', failedCount === 0, 
                                `Archivos JavaScript: ${loadedCount}/${scripts.length} cargados`);
                        }
                    })
                    .catch(error => {
                        failedCount++;
                        logError(`Error cargando ${script}: ${error.message}`);
                        
                        if (loadedCount + failedCount === scripts.length) {
                            updateTestResult('test-scripts', false, 
                                `Archivos JavaScript: ${loadedCount}/${scripts.length} cargados`);
                        }
                    });
            });
        }
        
        function testStyles() {
            const styles = ['css/styles.css', 'css/login.css'];
            
            let loadedCount = 0;
            let failedCount = 0;
            
            styles.forEach(style => {
                fetch(style)
                    .then(response => {
                        if (response.ok) {
                            loadedCount++;
                        } else {
                            failedCount++;
                            logError(`No se pudo cargar: ${style}`);
                        }
                        
                        if (loadedCount + failedCount === styles.length) {
                            updateTestResult('test-styles', failedCount === 0, 
                                `Archivos CSS: ${loadedCount}/${styles.length} cargados`);
                        }
                    })
                    .catch(error => {
                        failedCount++;
                        logError(`Error cargando ${style}: ${error.message}`);
                        
                        if (loadedCount + failedCount === styles.length) {
                            updateTestResult('test-styles', false, 
                                `Archivos CSS: ${loadedCount}/${styles.length} cargados`);
                        }
                    });
            });
        }
        
        function testStorage() {
            try {
                // Verificar si localStorage está disponible
                if (typeof(Storage) === "undefined") {
                    updateTestResult('test-storage', false, 'localStorage no está disponible');
                    logError('localStorage no está disponible en este navegador');
                    return;
                }
                
                // Probar escribir y leer
                const testKey = 'laundry_test';
                const testValue = 'test_data';
                
                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                if (retrieved === testValue) {
                    updateTestResult('test-storage', true, 'localStorage funcionando correctamente');
                } else {
                    updateTestResult('test-storage', false, 'localStorage no funciona correctamente');
                    logError('localStorage no puede almacenar/recuperar datos');
                }
                
            } catch (error) {
                updateTestResult('test-storage', false, 'Error en localStorage');
                logError(`Error en localStorage: ${error.message}`);
            }
        }
        
        function testApp() {
            try {
                // Verificar funciones básicas
                const hasConsole = typeof console !== 'undefined';
                const hasJSON = typeof JSON !== 'undefined';
                const hasFetch = typeof fetch !== 'undefined';
                
                if (hasConsole && hasJSON && hasFetch) {
                    updateTestResult('test-app', true, 'Entorno del navegador compatible');
                } else {
                    updateTestResult('test-app', false, 'Entorno del navegador incompatible');
                    if (!hasConsole) logError('Console no disponible');
                    if (!hasJSON) logError('JSON no disponible');
                    if (!hasFetch) logError('Fetch API no disponible');
                }
                
            } catch (error) {
                updateTestResult('test-app', false, 'Error verificando aplicación');
                logError(`Error en verificación de app: ${error.message}`);
            }
        }
        
        function clearData() {
            if (confirm('¿Estás seguro de que quieres limpiar todos los datos del sistema?')) {
                try {
                    // Limpiar datos específicos del sistema
                    const keys = Object.keys(localStorage);
                    keys.forEach(key => {
                        if (key.startsWith('laundry_') || key.includes('laund')) {
                            localStorage.removeItem(key);
                        }
                    });
                    
                    alert('✅ Datos limpiados correctamente. El sistema se reiniciará con datos de ejemplo.');
                } catch (error) {
                    alert('❌ Error limpiando datos: ' + error.message);
                }
            }
        }
        
        // Ejecutar pruebas automáticamente al cargar
        window.onload = function() {
            setTimeout(runTests, 500);
        };
    </script>
</body>
</html>


