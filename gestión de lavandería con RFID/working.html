<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de GestiÃ³n de LavanderÃ­a RFID</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ§º</text></svg>">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/login.css">
</head>
<body>
    <div id="app">
        <!-- Pantalla de Login (inicial) -->
        <div id="login-screen" class="screen active">
            <div class="login-container">
                <div class="login-box">
                    <div class="logo">
                        <h1>ğŸ§º LavanderÃ­aRFID</h1>
                        <p>Sistema de GestiÃ³n Inteligente</p>
                    </div>
                    <form id="login-form">
                        <div class="input-group">
                            <label for="username">Usuario</label>
                            <input type="text" id="username" name="username" value="admin" required>
                        </div>
                        <div class="input-group">
                            <label for="password">ContraseÃ±a</label>
                            <input type="password" id="password" name="password" value="admin123" required>
                        </div>
                        <button type="submit" class="login-btn">Iniciar SesiÃ³n</button>
                    </form>
                    <div class="demo-credentials">
                        <p><strong>Credenciales de demo:</strong></p>
                        <p>Usuario: admin | ContraseÃ±a: admin123</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pantalla Principal (despuÃ©s del login) -->
        <div id="main-screen" class="screen">
            <!-- Sidebar Navigation -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <h2>ğŸ§º LavanderÃ­aRFID</h2>
                </div>
                <ul class="sidebar-menu">
                    <li><a href="#" data-page="dashboard" class="menu-item active">ğŸ“Š Dashboard</a></li>
                    <li><a href="#" data-page="clients" class="menu-item">ğŸ‘¥ Clientes</a></li>
                    <li><a href="#" data-page="reception" class="menu-item">ğŸ“¥ RecepciÃ³n</a></li>
                    <li><a href="#" data-page="control" class="menu-item">âš™ï¸ Control Interno</a></li>
                    <li><a href="#" data-page="delivery" class="menu-item">ğŸ“¤ Entrega</a></li>
                    <li><a href="#" data-page="history" class="menu-item">ğŸ“‹ Historial</a></li>
                    <li><a href="#" data-page="reports" class="menu-item">ğŸ“ˆ Reportes</a></li>
                    <li><a href="#" data-page="guides" class="menu-item">ğŸ“„ GuÃ­as</a></li>
                </ul>
                <div class="sidebar-footer">
                    <button id="logout-btn" class="logout-btn">ğŸšª Cerrar SesiÃ³n</button>
                </div>
            </nav>

            <!-- Main Content Area -->
            <main class="main-content">
                <div id="page-content">
                    <!-- Las pÃ¡ginas se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
                </div>
            </main>
        </div>
    </div>

    <!-- Scripts en orden correcto -->
    <script>
        // Sistema simplificado integrado
        console.log('ğŸš€ Iniciando sistema integrado...');

        // Variables globales
        let currentUser = null;
        let currentPage = 'dashboard';

        // InicializaciÃ³n cuando el DOM estÃ© listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“± DOM cargado, inicializando sistema...');
            
            initializeSystem();
            checkExistingSession();
            setupEventListeners();
        });

        function initializeSystem() {
            console.log('âš™ï¸ Inicializando sistema...');
            
            // Inicializar localStorage si no existe
            if (!localStorage.getItem('laundry_initialized')) {
                initializeDefaultData();
                localStorage.setItem('laundry_initialized', 'true');
                console.log('âœ… Datos de ejemplo inicializados');
            }
        }

        function initializeDefaultData() {
            const clients = [
                {
                    id: 1,
                    name: 'Javier RodrÃ­guez',
                    cedula: '12345678',
                    phone: '555-0001',
                    email: 'javier@email.com',
                    createdAt: new Date().toISOString(),
                    totalServices: 5
                },
                {
                    id: 2,
                    name: 'MarÃ­a GonzÃ¡lez',
                    cedula: '87654321',
                    phone: '555-0002',
                    email: 'maria@email.com',
                    createdAt: new Date().toISOString(),
                    totalServices: 3
                }
            ];

            const garments = [
                {
                    id: 1,
                    rfidCode: 'RFID001',
                    clientId: 1,
                    type: 'Buzo',
                    color: 'Azul',
                    status: 'listo',
                    receivedAt: new Date().toISOString()
                }
            ];

            localStorage.setItem('laundry_clients', JSON.stringify(clients));
            localStorage.setItem('laundry_garments', JSON.stringify(garments));
            localStorage.setItem('laundry_guides', JSON.stringify([]));
            localStorage.setItem('laundry_history', JSON.stringify([]));
        }

        function checkExistingSession() {
            const savedUser = localStorage.getItem('current_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainScreen();
            } else {
                showLoginScreen();
            }
        }

        function showLoginScreen() {
            document.getElementById('login-screen').classList.add('active');
            document.getElementById('main-screen').classList.remove('active');
        }

        function showMainScreen() {
            console.log('ğŸ–¥ï¸ Mostrando pantalla principal...');
            document.getElementById('login-screen').classList.remove('active');
            document.getElementById('main-screen').classList.add('active');
            
            // Cargar dashboard
            setTimeout(() => {
                loadPage('dashboard');
            }, 100);
        }

        function setupEventListeners() {
            // Login form
            const loginForm = document.getElementById('login-form');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }

            // Logout button
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', handleLogout);
            }

            // Menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    if (page) {
                        loadPage(page);
                        updateActiveMenu(this);
                    }
                });
            });
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            console.log('ğŸ”‘ Procesando login...', username);
            
            if (validateCredentials(username, password)) {
                const user = {
                    id: 1,
                    username: username,
                    name: 'Administrador',
                    role: 'admin',
                    loginTime: new Date().toISOString()
                };

                localStorage.setItem('current_user', JSON.stringify(user));
                currentUser = user;
                
                console.log('âœ… Login exitoso');
                showMainScreen();
                showMessage('Â¡Bienvenido, ' + user.name + '!', 'success');
            } else {
                console.log('âŒ Credenciales invÃ¡lidas');
                showMessage('Credenciales incorrectas', 'error');
            }
        }

        function validateCredentials(username, password) {
            return (username === 'admin' && password === 'admin123') ||
                   (username === 'operador' && password === 'op123');
        }

        function handleLogout() {
            if (confirm('Â¿EstÃ¡ seguro que desea cerrar sesiÃ³n?')) {
                localStorage.removeItem('current_user');
                currentUser = null;
                showLoginScreen();
                showMessage('SesiÃ³n cerrada correctamente', 'info');
            }
        }

        function loadPage(pageName) {
            console.log('ğŸ“„ Cargando pÃ¡gina:', pageName);
            currentPage = pageName;
            
            const pageContent = document.getElementById('page-content');
            if (!pageContent) return;

            let content = '';
            
            switch (pageName) {
                case 'dashboard':
                    content = renderDashboard();
                    break;
                case 'clients':
                    content = renderClients();
                    break;
                case 'reception':
                    content = renderReception();
                    break;
                case 'control':
                    content = renderControl();
                    break;
                case 'delivery':
                    content = renderDelivery();
                    break;
                case 'history':
                    content = renderHistory();
                    break;
                case 'reports':
                    content = renderReports();
                    break;
                case 'guides':
                    content = renderGuides();
                    break;
                default:
                    content = renderDashboard();
            }
            
            pageContent.innerHTML = content;
        }

        function renderDashboard() {
            const clients = JSON.parse(localStorage.getItem('laundry_clients') || '[]');
            const garments = JSON.parse(localStorage.getItem('laundry_garments') || '[]');
            
            return `
                <div class="page-header">
                    <h1>ğŸ“Š Dashboard</h1>
                    <p>Resumen del estado del sistema de lavanderÃ­a</p>
                </div>
                
                <div class="grid grid-4 mb-3">
                    <div class="card text-center">
                        <h3 class="text-primary">${clients.length}</h3>
                        <p class="text-muted">Clientes Registrados</p>
                        <small class="badge badge-info">ğŸ‘¥ Total</small>
                    </div>
                    <div class="card text-center">
                        <h3 class="text-warning">${garments.filter(g => g.status === 'en_proceso').length}</h3>
                        <p class="text-muted">Prendas en Proceso</p>
                        <small class="badge badge-warning">âš™ï¸ En curso</small>
                    </div>
                    <div class="card text-center">
                        <h3 class="text-success">${garments.filter(g => g.status === 'listo').length}</h3>
                        <p class="text-muted">Prendas Listas</p>
                        <small class="badge badge-success">âœ… Completadas</small>
                    </div>
                    <div class="card text-center">
                        <h3 class="text-info">${garments.length}</h3>
                        <p class="text-muted">Total Prendas</p>
                        <small class="badge badge-info">ğŸ“¦ Inventario</small>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ‰ Â¡Sistema Funcionando!</h3>
                        <p class="card-subtitle">Prototipo de gestiÃ³n de lavanderÃ­a con RFID</p>
                    </div>
                    <div style="padding: 20px;">
                        <div class="alert alert-success">
                            <strong>âœ… Login exitoso:</strong> El sistema de autenticaciÃ³n estÃ¡ funcionando correctamente.
                        </div>
                        <div class="alert alert-info">
                            <strong>ğŸ”„ Sistema integrado:</strong> Todos los mÃ³dulos bÃ¡sicos estÃ¡n cargados y operativos.
                        </div>
                        <div class="alert alert-warning">
                            <strong>ğŸš§ Prototipo:</strong> Esta es una versiÃ³n de demostraciÃ³n con funcionalidades bÃ¡sicas.
                        </div>
                        
                        <h4>ğŸš€ Funcionalidades Disponibles:</h4>
                        <ul>
                            <li>âœ… Sistema de login con localStorage</li>
                            <li>âœ… NavegaciÃ³n entre mÃ³dulos</li>
                            <li>âœ… Dashboard con estadÃ­sticas bÃ¡sicas</li>
                            <li>âœ… GestiÃ³n de datos en localStorage</li>
                            <li>âœ… Interfaz responsiva y moderna</li>
                        </ul>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="loadPage('clients')">ğŸ‘¥ Ver Clientes</button>
                            <button class="btn btn-success" onclick="testSystem()">ğŸ§ª Probar Sistema</button>
                            <button class="btn btn-info" onclick="showSystemInfo()">â„¹ï¸ Info del Sistema</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderClients() {
            const clients = JSON.parse(localStorage.getItem('laundry_clients') || '[]');
            
            return `
                <div class="page-header">
                    <h1>ğŸ‘¥ GestiÃ³n de Clientes</h1>
                    <p>Administra la base de datos de clientes</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Lista de Clientes (${clients.length})</h3>
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>CÃ©dula</th>
                                    <th>TelÃ©fono</th>
                                    <th>Servicios</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${clients.map(client => `
                                    <tr>
                                        <td>${client.id}</td>
                                        <td>${client.name}</td>
                                        <td>${client.cedula}</td>
                                        <td>${client.phone}</td>
                                        <td><span class="badge badge-info">${client.totalServices}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderReception() {
            return `
                <div class="page-header">
                    <h1>ğŸ“¥ RecepciÃ³n de Prendas</h1>
                    <p>Registro de prendas con tecnologÃ­a RFID</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function renderControl() {
            return `
                <div class="page-header">
                    <h1>âš™ï¸ Control Interno</h1>
                    <p>Seguimiento y control de estados de prendas</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function renderDelivery() {
            return `
                <div class="page-header">
                    <h1>ğŸ“¤ Entrega de Prendas</h1>
                    <p>Proceso de entrega con validaciÃ³n automÃ¡tica</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function renderHistory() {
            return `
                <div class="page-header">
                    <h1>ğŸ“‹ Historial de Servicios</h1>
                    <p>Consulta completa de servicios y movimientos</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function renderReports() {
            return `
                <div class="page-header">
                    <h1>ğŸ“ˆ Reportes y Balances</h1>
                    <p>AnÃ¡lisis estadÃ­stico y reportes del sistema</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function renderGuides() {
            return `
                <div class="page-header">
                    <h1>ğŸ“„ GestiÃ³n de GuÃ­as</h1>
                    <p>AdministraciÃ³n de guÃ­as de recepciÃ³n y entrega</p>
                </div>
                <div class="card">
                    <div style="padding: 40px; text-align: center;">
                        <h3>ğŸ”§ MÃ³dulo en Desarrollo</h3>
                        <p>Esta funcionalidad estarÃ¡ disponible en la versiÃ³n completa.</p>
                        <button class="btn btn-primary" onclick="loadPage('dashboard')">â† Volver al Dashboard</button>
                    </div>
                </div>
            `;
        }

        function updateActiveMenu(activeItem) {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            activeItem.classList.add('active');
        }

        function showMessage(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <span>${message}</span>
                <button onclick="this.parentElement.remove()">&times;</button>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                z-index: 10000;
                max-width: 300px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                display: flex;
                justify-content: space-between;
                align-items: center;
            `;

            const colors = {
                success: '#48bb78',
                error: '#f56565',
                warning: '#ed8936',
                info: '#4299e1'
            };
            notification.style.backgroundColor = colors[type] || colors.info;

            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function testSystem() {
            alert('ğŸ§ª Test del Sistema:\n\nâœ… Login funcionando\nâœ… NavegaciÃ³n activa\nâœ… localStorage operativo\nâœ… Interfaz responsiva\n\nÂ¡Sistema funcionando correctamente!');
        }

        function showSystemInfo() {
            const info = `
Sistema: GestiÃ³n de LavanderÃ­a RFID
VersiÃ³n: 1.0 (Prototipo)
Usuario: ${currentUser ? currentUser.name : 'No logueado'}
Hora: ${new Date().toLocaleString('es-ES')}
Datos: ${localStorage.length} elementos en localStorage
Estado: âœ… Operativo
            `;
            alert(info);
        }
    </script>
</body>
</html>


